---
title: Mysql任意时间范围内按任意时段分组    
date: 2017-01-18 16:16:07   
tags:   
- Mysql
---

上代码：
```Mysql
set @timeBegin='2017-01-17 00:00:00';
set @interval=60*10;
select FROM_UNIXTIME(FLOOR(UNIX_TIMESTAMP(`BUYTIME`)/@interval)*@interval) as timeNearTo, count(*) as 'count' 
from wg_device_sale
where BUYTIME>=@timeBegin AND BUYTIME<=DATE_ADD(@timeBegin,INTERVAL 1 DAY)
group by timeNearTo 
order by timeNearTo desc;
```

结果：

| timeNearTo         | count|
| ------------------ | ---- |
|2017-01-17 23:00:00 | 6    |
|2017-01-17 23:30:00 | 1    |
|2017-01-17 22:30:00 | 8    |
|2017-01-17 22:00:00 | 6    |
|2017-01-17 21:30:00 | 14   |
|2017-01-17 21:00:00 | 18   |
|2017-01-17 20:30:00 | 24   |
|2017-01-17 20:00:00 | 28   |
|2017-01-17 19:30:00 | 37   |
|2017-01-17 19:00:00 | 25   |
|2017-01-17 18:30:00 | 21   |
|2017-01-17 18:00:00 | 37   |
|2017-01-17 17:30:00 | 36   |
|2017-01-17 17:00:00 | 48   |
|2017-01-17 16:30:00 | 31   |
|2017-01-17 16:00:00 | 46   |
|2017-01-17 15:30:00 | 36   |
|2017-01-17 15:00:00 | 37   |
|2017-01-17 14:30:00 | 33   |
|2017-01-17 14:00:00 | 31   |
|2017-01-17 13:30:00 | 41   |
|2017-01-17 13:00:00 | 37   |
|2017-01-17 12:30:00 | 22   |
|2017-01-17 12:00:00 | 30   |
|2017-01-17 11:30:00 | 33   |
|2017-01-17 11:00:00 | 27   |
|2017-01-17 10:30:00 | 21   |
|2017-01-17 10:00:00 | 23   |
|2017-01-17 09:30:00 | 8  |
|2017-01-17 09:00:00 | 9  |
|2017-01-17 08:30:00 | 2  |
|2017-01-17 08:00:00 | 1  |
|2017-01-17 07:00:00 | 1  |
|2017-01-17 00:30:00 | 1  |
|2017-01-17 00:00:00 | 1  |


	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	